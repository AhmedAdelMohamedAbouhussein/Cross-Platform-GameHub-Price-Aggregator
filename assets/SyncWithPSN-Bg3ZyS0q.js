import{u as m,r as d,j as s,L as b,H as y,F as _,a as p}from"./index-DTw5IBFM.js";import{A as x}from"./Aside-CE7qS0Cu.js";import"./index-OaW0WkL9.js";const N="_container_q4rvb_1",g="_body_q4rvb_9",h="_main_q4rvb_15",j="_buttonContainer_q4rvb_26",f="_button_q4rvb_26",n={container:N,body:g,main:h,buttonContainer:j,button:f};function w(){const l=m(),u=void 0,[o,e]=d.useState(""),[i,r]=d.useState(!1),S=()=>{r(!0),e("Syncing...");const c=async t=>{if(t.data.type==="NPSSO_RESPONSE"){if(t.data.npsso)try{const a=t.data.npsso;await p.post(`${u}/sync/psn`,{npsso:a},{withCredentials:!0}),l("/library")}catch(a){e("Sync failed"),console.error(a.response?.data?.error||a.message),console.log("Failed NPSSO:",t.data.npsso)}else e("NPSSO not found. Please log in to PSN.");r(!1),window.removeEventListener("message",c)}};window.addEventListener("message",c),window.postMessage({type:"REQUEST_NPSSO"})};return s.jsxs("div",{className:n.container,children:[i&&s.jsx(b,{})," ",s.jsx(y,{}),s.jsxs("div",{className:n.body,children:[s.jsx(x,{}),s.jsxs("main",{className:n.main,children:[s.jsx("h1",{children:"Connect your PlayStation account"}),s.jsx("div",{className:n.buttonContainer,children:s.jsx("button",{onClick:S,className:n.button,disabled:i,children:"Sync With PSN"})}),o&&s.jsx("p",{className:n.status,children:o})]})]}),s.jsx(_,{})]})}export{w as default};
