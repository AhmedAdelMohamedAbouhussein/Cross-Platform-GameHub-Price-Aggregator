import{u as b,r as c,j as s,H as m,F as y,a as _}from"./index-CF71GRAX.js";import{A as p}from"./Aside-BXzvea8e.js";import"./index-D63VvsJ_.js";const x="_container_q4rvb_1",N="_body_q4rvb_9",g="_main_q4rvb_15",h="_buttonContainer_q4rvb_26",j="_button_q4rvb_26",n={container:x,body:N,main:g,buttonContainer:h,button:j};function E(){const d=b(),l=void 0,[u,e]=c.useState(""),[o,i]=c.useState(!1),S=()=>{i(!0),e("Syncing...");const r=async t=>{if(t.data.type==="NPSSO_RESPONSE"){if(t.data.npsso)try{const a=t.data.npsso;await _.post(`${l}/sync/psn`,{npsso:a},{withCredentials:!0}),d("/library")}catch(a){e("Sync failed"),console.error(a.response?.data?.error||a.message),console.log("Failed NPSSO:",t.data.npsso)}else e("NPSSO not found. Please log in to PSN.");i(!1),window.removeEventListener("message",r)}};window.addEventListener("message",r),window.postMessage({type:"REQUEST_NPSSO"})};return s.jsxs("div",{className:n.container,children:[s.jsx(m,{}),s.jsxs("div",{className:n.body,children:[s.jsx(p,{}),s.jsxs("main",{className:n.main,children:[s.jsx("h1",{children:"Connect your PlayStation account"}),s.jsx("div",{className:n.buttonContainer,children:s.jsx("button",{onClick:S,className:n.button,disabled:o,children:o?"Syncing...":"Sync With PSN"})}),s.jsxs("p",{children:[" ",u]})]})]}),s.jsx(y,{})]})}export{E as default};
