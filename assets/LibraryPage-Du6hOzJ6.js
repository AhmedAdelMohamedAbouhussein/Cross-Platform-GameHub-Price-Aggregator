import{g as N,j as e,b as O,r as f,A as S,H as E,F as A,a as I}from"./index-CsEmHfSi.js";import{A as k}from"./Aside-DwwxLXeW.js";import"./index-JAjUgTVY.js";var _={exports:{}},x,v;function W(){if(v)return x;v=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return x=s,x}var j,T;function G(){if(T)return j;T=1;var s=W();function p(){}function o(){}return o.resetWarningCache=p,j=function(){function r(m,n,g,c,h,i){if(i!==s){var t=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw t.name="Invariant Violation",t}}r.isRequired=r;function a(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:o,resetWarningCache:p};return l.PropTypes=l,l},j}var P;function F(){return P||(P=1,_.exports=G()()),_.exports}var q=F();const d=N(q),D="_card_1mlff_1",L="_defaultOverlay_1mlff_30",$="_progressWrapper_1mlff_40",B="_cardImage_1mlff_59",M="_classTitle_1mlff_78",u={card:D,defaultOverlay:L,progressWrapper:$,cardImage:B,classTitle:M},H="_progressCircle_q6ean_1",U="_progressCircleText_q6ean_12",b={progressCircle:H,progressCircleText:U};function V({progress:s}){const r=2*Math.PI*45,a=r*(1-s/100);return e.jsxs("svg",{width:"100",height:"100",className:b.progressCircle,children:[e.jsx("circle",{cx:"50",cy:"50",r:45,stroke:"#e6e6e6",strokeWidth:10,fill:"none"}),e.jsx("circle",{cx:"50",cy:"50",r:45,stroke:"#4caf50",strokeWidth:10,fill:"none",strokeDasharray:r,strokeDashoffset:a,strokeLinecap:"round",transform:"rotate(-90 50 50)"}),e.jsxs("text",{x:"50%",y:"50%",textAnchor:"middle",dy:"0.3em",className:b.progressCircleText,children:[s,"%"]})]})}function w(s){const p=s.id,o=s.platform.trim(),r=s.title,a=s.image.trim()!==""?s.image:"https://static.vecteezy.com/system/resources/previews/008/255/804/non_2x/page-not-found-error-404-system-updates-uploading-computing-operation-installation-programs-system-maintenance-graffiti-sprayed-page-not-found-error-404-isolated-on-white-background-vector.jpg",l=s.progress,m=s.lastPlayed?new Date(s.lastPlayed).toLocaleDateString():"Game hasn't been played",n=s.hoursPlayed,g=O(),c=f.useRef(null),[h,i]=f.useState(!1);return f.useEffect(()=>{const t=new IntersectionObserver(C=>{C.forEach(R=>{R.isIntersecting&&(console.log(`Card ${r} is now visible`),i(!0),t.disconnect())})},{threshold:.2});return c.current&&t.observe(c.current),()=>{c.current&&t.unobserve(c.current)}},[]),e.jsx("div",{ref:c,className:u.card,onClick:()=>g(`/ownedgamedetails?platform=${o}&id=${p}`),children:h?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:a,alt:r+" picture",loading:"lazy",className:u.cardImage}),e.jsx("h2",{className:u.classTitle,children:s.title}),e.jsxs("p",{children:["Bought on: ",o]}),e.jsx("div",{className:u.progressWrapper,children:e.jsx(V,{progress:l})}),e.jsx("div",{className:u.defaultOverlay,children:e.jsx("p",{children:"Hover to see progress"})}),e.jsxs("p",{children:["Total Hours: ",n]}),e.jsxs("p",{children:["Last Played: ",m]})]}):e.jsx("div",{className:u.placeholder,children:"Loading..."})})}w.propTypes={title:d.string.isRequired,image:d.string,platform:d.string,progress:d.number,lastPlayed:d.oneOfType([d.string,d.instanceOf(Date)])};const z="_container_j4fgl_1",K="_body_j4fgl_9",Y="_main_j4fgl_15",J="_cardGrid_j4fgl_23",y={container:z,body:K,main:Y,cardGrid:J};function ee(){const{user:o}=f.useContext(S),[r,a]=f.useState(null);f.useEffect(()=>{window.scrollTo(0,0);const m=async()=>{try{const n=await I.post("undefined/api/users/ownedgames",{userId:o._id});a(n.data.ownedGames),console.log("Fetched owned games:",n.data.ownedGames)}catch(n){console.error("Fetch failed:",n)}};o?._id&&m()},[o,void 0]);const l=()=>{if(!r)return e.jsx("p",{children:"Loading games..."});const m=new Map(Object.entries(r));return Array.from(m.entries()).flatMap(([n,g])=>{const c=new Map(Object.entries(g));return Array.from(c.entries()).sort((i,t)=>t[1].progress-i[1].progress).map(([i,t])=>e.jsx(w,{id:i,platform:n,image:t.coverImage,title:t.gameName,progress:t.progress,lastPlayed:t.lastPlayed,hoursPlayed:t.hoursPlayed},`${n}-${i}`))})};return e.jsxs("div",{className:y.container,children:[e.jsx(E,{}),e.jsxs("div",{className:y.body,children:[e.jsx(k,{}),e.jsx("main",{className:y.main,children:e.jsx("div",{className:y.cardGrid,children:l()})})]}),e.jsx(A,{})]})}export{ee as default};
