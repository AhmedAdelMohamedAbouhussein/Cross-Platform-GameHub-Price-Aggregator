import{r as l,A as N,b as v,j as e,H as f,F as q,a as u}from"./index-r3KsZGA1.js";const k="_container_bz21q_1",C="_page_bz21q_11",y="_title_bz21q_22",R="_tabs_bz21q_28",B="_tab_bz21q_28",w="_active_bz21q_50",z="_content_bz21q_56",$="_section_bz21q_64",D="_input_bz21q_75",F="_friendList_bz21q_83",P="_friendBar_bz21q_94",A="_btnPrimary_bz21q_109",L="_btnDanger_bz21q_124",S="_btnBack_bz21q_138",U="_feedback_bz21q_154",E="_buttonContainer_bz21q_165",n={container:k,page:C,title:y,tabs:R,tab:B,active:w,content:z,section:$,input:D,friendList:F,friendBar:P,btnPrimary:A,btnDanger:L,btnBack:S,feedback:U,buttonContainer:E};function K(){const{user:r}=l.useContext(N),m=v(),[d,o]=l.useState("add"),[h,_]=l.useState(""),[a,c]=l.useState(""),i=r?.friends?Object.values(r.friends).flat().filter(s=>s.source==="User"):[],p=async s=>{try{const t=await u.post(`undefined/friends/add/${s}`,{userId:r._id});c(t.data.message||"Request sent!")}catch(t){c(t.response?.data?.message||"Something went wrong.")}},x=async s=>{try{const t=await u.post(`undefined/friends/accept/${s}`,{userId:r._id});c(t.data.message||"Request accepted!")}catch(t){c(t.response?.data?.message||"Something went wrong.")}},b=async s=>{try{const t=await u.post(`undefined/friends/reject/${s}`,{userId:r._id});c(t.data.message||"Request rejected!")}catch(t){c(t.response?.data?.message||"Something went wrong.")}},j=async s=>{try{const t=await u.post(`undefined/friends/remove/${s}`,{userId:r._id});c(t.data.message||"Friend removed!")}catch(t){c(t.response?.data?.message||"Something went wrong.")}},g=()=>{switch(d){case"add":return e.jsxs("div",{className:n.section,children:[e.jsx("h2",{children:"Add Friend"}),e.jsx("input",{type:"text",placeholder:"Enter UserID",className:n.input,onChange:s=>_(s.target.value)}),e.jsx("button",{className:n.btnPrimary,onClick:()=>p(h),children:" Send Request "}),a&&e.jsx("p",{className:n.feedback,children:a})]});case"sent":return e.jsxs("div",{className:n.section,children:[e.jsx("h2",{children:"Pending Requests (Sent)"}),e.jsx("ul",{className:n.friendList,children:i.filter(s=>s.status==="pending"&&s.requestedByMe).length?i.filter(s=>s.status==="pending"&&s.requestedByMe).map((s,t)=>e.jsxs("li",{className:n.friendBar,children:[e.jsx("span",{children:s.displayName||"Unknown"}),e.jsx("button",{className:n.btnDanger,onClick:()=>b(s.user),children:" Cancel "})]},t)):e.jsx("li",{children:"No pending requests sent"})}),a&&e.jsx("p",{className:n.feedback,children:a})]});case"received":return e.jsxs("div",{className:n.section,children:[e.jsx("h2",{children:"Pending Requests (Received)"}),e.jsx("ul",{className:n.friendList,children:i.filter(s=>s.status==="pending"&&!s.requestedByMe).length?i.filter(s=>s.status==="pending"&&!s.requestedByMe).map((s,t)=>e.jsxs("li",{className:n.friendBar,children:[e.jsx("span",{children:s.displayName||"Unknown"}),e.jsxs("div",{className:n.buttonContainer,children:[e.jsx("button",{className:n.btnPrimary,onClick:()=>x(s.user),children:" Accept "}),e.jsx("button",{className:n.btnDanger,onClick:()=>b(s.user),children:" Reject "})]})]},t)):e.jsx("li",{children:"No pending requests received"})}),a&&e.jsx("p",{className:n.feedback,children:a})]});case"remove":return e.jsxs("div",{className:n.section,children:[e.jsx("h2",{children:"Remove Friend"}),e.jsx("ul",{className:n.friendList,children:i.filter(s=>s.status==="accepted").length?i.filter(s=>s.status==="accepted").map((s,t)=>e.jsxs("li",{className:n.friendBar,children:[e.jsx("span",{children:s.displayName||"Unknown"}),e.jsx("button",{className:n.btnDanger,onClick:()=>j(s.user),children:" Remove "})]},t)):e.jsx("li",{children:"No friends to remove"})}),a&&e.jsx("p",{className:n.feedback,children:a})]});default:return null}};return e.jsxs("div",{className:n.container,children:[e.jsx(f,{}),e.jsxs("div",{className:n.page,children:[e.jsx("h1",{className:n.title,children:"Manage Friends"}),e.jsxs("div",{className:n.tabs,children:[e.jsx("button",{className:`${n.tab} ${d==="add"?n.active:""}`,onClick:()=>o("add"),children:"Add Friend"}),e.jsx("button",{className:`${n.tab} ${d==="sent"?n.active:""}`,onClick:()=>o("sent"),children:" Pending Sent "}),e.jsx("button",{className:`${n.tab} ${d==="received"?n.active:""}`,onClick:()=>o("received"),children:" Pending Received"}),e.jsx("button",{className:`${n.tab} ${d==="remove"?n.active:""}`,onClick:()=>o("remove"),children:"Remove Friend "})]}),e.jsx("div",{className:n.content,children:g()}),e.jsx("button",{className:n.btnBack,onClick:()=>m("/friends"),children:" ← Back to Friends "})]}),e.jsx(q,{})]})}export{K as default};
